SELECT r.nom_region AS region,
COUNT(v.id_vente) AS nombre_ventes_appartement_S1_2020
FROM vente v
JOIN
bien b ON b.id_bien = v.id_bien
JOIN
commune c ON c.id_codedep_codecommune = b.id_codedep_codecommune
JOIN
region r ON r.code_region = c.code_region
WHERE b.type_local = 'Appartement' AND
v.date BETWEEN '2020-01-01' AND '2020-06-30'
GROUP BY region
ORDER BY nombre_ventes_appartement_S1_2020 DESC;