SELECT b.nombre_pieces AS nombre_de_pieces,
FORMAT('%2.2f%%', CAST (COUNT(v.id_vente) AS FLOAT) /
SUM(COUNT(v.id_vente) ) OVER () * 100) AS proportion_ventes_appartements
FROM vente v
JOIN
bien b ON b.id_bien = v.id_bien
WHERE b.type_local = 'Appartement'
GROUP BY nombre_de_pieces
ORDER BY nombre_de_pieces;