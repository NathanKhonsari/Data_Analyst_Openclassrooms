SELECT r.nom_region AS region,
ROUND(AVG( (CAST (v.valeur AS FLOAT) / b.surface_carrez) ), 0)
AS prix_au_m2_reel
FROM vente v
JOIN
bien b ON v.id_bien = b.id_bien
JOIN
commune c ON b.id_codedep_codecommune = c.id_codedep_codecommune
JOIN
region r ON c.code_region = r.code_region
WHERE b.type_local = 'Maison' AND
r.nom_region LIKE LOWER('%le%de%france') AND
v.valeur <> '';